<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üê± Cat Trivia Fill-in-the-Blank</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="overlay">
    <h1>üê± Cat Trivia Fill-in-the-Blank</h1>
    <p class="instructions">
      You'll see a cat fact for 5 seconds üêæ. After that, a word will be missing can you fill it in? ‚è≥
    </p>

    <div class="controls">
      <button id="startBtn">Start Game</button>
      <button id="cancelBtn" disabled>Cancel</button>
    </div>

    <div class="game-area">
      <p id="fact">Press "Start Game" to begin!</p>
      <input id="answer" type="text" placeholder="Type missing word..." disabled />
      <button id="submitBtn" disabled>Submit</button>
    </div>

    <div class="status">
      <p id="score">Score: 0</p>
      <p id="timer">Time left: 0s</p>
      <p id="result"></p>
    </div>
  </div>

  <script>
    const factEl = document.getElementById("fact");
    const startBtn = document.getElementById("startBtn");
    const cancelBtn = document.getElementById("cancelBtn");
    const resultEl = document.getElementById("result");
    const scoreEl = document.getElementById("score");
    const timerEl = document.getElementById("timer");
    const answerEl = document.getElementById("answer");
    const submitBtn = document.getElementById("submitBtn");

    let score = 0;
    let timeLeft = 30;
    let timer;
    let currentFact = "";
    let missingWord = "";

    async function fetchFact() {
      try {
        const res = await fetch("https://meowfacts.herokuapp.com/");
        const data = await res.json();
        return data.data[0];
      } catch (error) {
        return "Cats are amazing creatures!";
      }
    }

    function startGame() {
      score = 0;
      timeLeft = 30;
      scoreEl.textContent = "Score: 0";
      resultEl.textContent = "";
      factEl.textContent = "Loading fact...";
      startBtn.disabled = true;
      cancelBtn.disabled = false;
      answerEl.disabled = false;
      submitBtn.disabled = false;

      loadFact();

      if (timer) clearInterval(timer);
      timer = setInterval(() => {
        timeLeft--;
        timerEl.textContent = `Time left: ${timeLeft}s`;
        if (timeLeft <= 0) endGame("‚è≥ Time's up! Final Score: " + score);
      }, 1000);
    }

    async function loadFact() {
      currentFact = await fetchFact();
      factEl.textContent = currentFact;

      // Wait 5 seconds before hiding a word
      setTimeout(() => {
        const words = currentFact.split(" ");
        const index = Math.floor(Math.random() * words.length);
        missingWord = words[index].replace(/[^a-zA-Z]/g, ""); // strip punctuation
        words[index] = "_____";
        factEl.textContent = words.join(" ");
      }, 5000);
    }

    function checkAnswer() {
      const userAnswer = answerEl.value.trim().toLowerCase();
      if (userAnswer === missingWord.toLowerCase()) {
        score++;
        resultEl.textContent = "‚úÖ Correct!";
      } else {
        resultEl.textContent = `‚ùå Wrong! The missing word was: ${missingWord}`;
      }
      scoreEl.textContent = "Score: " + score;
      answerEl.value = "";
      loadFact();
    }

    function endGame(message) {
      clearInterval(timer);
      resultEl.textContent = message;
      startBtn.disabled = false;
      cancelBtn.disabled = true;
      answerEl.disabled = true;
      submitBtn.disabled = true;
    }

    function cancelGame() {
      clearInterval(timer);
      resultEl.textContent = "‚ùå Game canceled!";
      startBtn.disabled = false;
      cancelBtn.disabled = true;
      answerEl.disabled = true;
      submitBtn.disabled = true;
      scoreEl.textContent = "Score: 0";
      timerEl.textContent = "Time left: 0s";
    }

    startBtn.addEventListener("click", startGame);
    cancelBtn.addEventListener("click", cancelGame);
    submitBtn.addEventListener("click", checkAnswer);
  </script>
</body>
</html>
